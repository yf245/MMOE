# Code for 'Inducing Monotonicity in Mixture of Experts'

This repository contains the code and datasets used in our paper **"Inducing Monotonicity in Mixture of Experts."**

**Abstract**: Shape constraints, such as monotonicity, arise in many engineering and physical applications, as motivated by some underlying physics or existing theory. As such, a growing trend in machine learning calls for data-driven models that impose monotonicity constraints. Along those lines, this work is concerned with inducing monotonicity in the context of mixture of experts (MoE) models. MoE is a prevalent ensemble machine learning framework for modeling non-stationary data with distinct regimes. In the MoE framework, multiple machine learning models (referred to as experts) are trained on different data subsets and then merged to form a mixture using input-dependent weights (referred to as a gating mechanism). We show that achieving monotonicity in MoE models is non-trivial since the resulting mixture is not guaranteed to be monotone even if the constituting experts are. Motivated by that, we propose an MoE method that induces monotonicity by leveraging a special class of polynomial functions as experts, and then internalizing a constrained optimization model that directly acts on their coefficients. We show that, unlike the base MoE model, the proposed approach indeed produces monotone mixtures, and further demonstrate its effectiveness on a synthetic dataset and two case studies from materials failure and wind turbine performance, respectively.

## Getting Started

- **Requirements**: Python 3.9.7 
- **Installation**: 
	- Open your terminal and navigate to the local folder where you want the project to be in:  `cd /path/to/your/folder`
	- Run the clone command: `git clone https://github.com/yf245/MMOE.git`
	- Change into the cloned directory: `cd MMOE`
	- Create a virtual environment: `python3.9 -m venv <venv_name>`
	- Activate the virtual environment: `source <venv_name>/bin/activate` if on macOS/Linux
	- Install packages in the virtual environment: `pip install -r requirements.txt`
	- Open JupyterLab: `jupyter lab` 
	- Please refer to the next section for usage.
	- When you are done, deactivate the virtual environment: `deactivate`

## Usage

To reproduce the figures and the tables in our paper, please run one of the Jupyter Notebooks depending on the model of interest to you. 

More instructions will be available in the Notebooks to guide you further.

## File Structure

- `requirements.txt`: Lists all the packages you need
- `MMIE_and_Baseline_MoE.ipynb`: Contains all the code you need to generate or reproduce the results for MMIE and Baseline MoE models
- `Proposed_MMoE_and_GPR.ipynb`: Contains all the code you need to generate or reproduce the results for proposed MMoE and GPR models
- `data/`: Contains the data that will be used by the two Jupyter Notebooks
- `baseline_fitted_models/`: Contains the already fitted Baseline MoE and MMIE models for the turbine dataset
- `proposed_fitted_models/`: Contains the already fitted proposed MMoE model for the turbine dataset
-  `publication_figures/`: Will contain the figures generated by the Notebooks if you chose to save the figures locally
